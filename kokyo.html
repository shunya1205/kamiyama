<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>『故郷』完全学習ツール：診断＆探究資料</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel (for JSX) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;700;900&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: "Noto Sans JP", sans-serif; background-color: #f8fafc; color: #1e293b; }
        h1, h2, h3, h4, .serif { font-family: "Noto Serif JP", serif; }
        /* アニメーション定義 */
        .slide-in { animation: slideIn 0.4s ease-out forwards; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- Icons Wrapper ---
        const Icon = ({ name, className, size = 24 }) => {
            useEffect(() => { lucide.createIcons(); }, [name]);
            return <i data-lucide={name} className={className} width={size} height={size}></i>;
        };

        // --- Questions Data (Shared) ---
        const questions = [
            {
                category: "カテゴリーA：【もしも…】お金の条件を変えてみる",
                icon: "banknote", color: "text-emerald-600",
                items: [
                    { 
                        id: 1, 
                        q: "もし閏土が宝くじに当たって大金持ちになっていたら、「私」を「旦那様」と呼んだかな？", 
                        options: [
                            { type: 'money', label: "呼ばない", sub: "「やあ、迅ちゃん！」と呼ぶ", reason: "「お金さえあれば対等になれた」と考えているからです。今の卑屈な態度は性格ではなく、貧しさが作らせたものだと捉えています。" }, 
                            { type: 'heart', label: "やっぱり呼ぶ", sub: "金持ちでも丁寧語を使う", reason: "「お金があっても、染み付いた身分意識や上下関係は消えない」と考えているからです。壁の原因は心の中のルールにあります。" }
                        ] 
                    },
                    { 
                        id: 2, 
                        q: "もし「私」が大富豪で、「閏ちゃん、これ100万円あげるよ」と言ったら、二人の壁は消えたかな？", 
                        options: [
                            { type: 'money', label: "消える", sub: "泣いて感謝して仲良くなる", reason: "今の気まずさは、「助けてあげられない無力感」や「生活の苦しさ」から来ていると考えているからです。解決策（カネ）があれば壁は壊せます。" }, 
                            { type: 'heart', label: "消えない", sub: "逆に恐縮して距離ができる", reason: "「施し（めぐみ）」を受けることで、余計に惨めさや上下関係が強調されると考えているからです。心の距離はお金では買えません。" }
                        ] 
                    }
                ]
            },
            {
                category: "カテゴリーB：【場面転換】シチュエーションを変えてみる",
                icon: "message-circle", color: "text-blue-600",
                items: [
                    { 
                        id: 3, 
                        q: "もし二人がスタバのようなカフェに入って、2時間お茶をすることになったら、会話は続く？", 
                        options: [
                            { type: 'money', label: "続かない", sub: "沈黙しちゃう", reason: "仲が悪いのではなく、単に「共通の話題」がないだけだと捉えています。話題の差は、教育や旅などの「経験（カネで買うもの）」の差です。" }, 
                            { type: 'heart', label: "続く", sub: "昔話で盛り上がる", reason: "本来なら話せるはずなのに、会話がなかったのは「私」が勝手に期待して、勝手にガッカリした（心を閉ざした）からだと捉えています。" }
                        ] 
                    },
                    { 
                        id: 4, 
                        q: "もし周りに誰もいなくて、完全な二人きりの密室だったら、閏土は「迅ちゃん」と呼べたかな？", 
                        options: [
                            { type: 'money', label: "呼べた", sub: "甘えられた", reason: "閏土が他人行儀なのは、本心からではなく「周りの目」や「村の空気」を気にしているからだと捉えています。貧しい村の空気が彼を縛っています。" }, 
                            { type: 'heart', label: "呼べない", sub: "やっぱり無理", reason: "誰が見ていなくても、閏土自身のプライドや恐怖心が邪魔をすると考えているからです。「落ちぶれた自分」を認めたくないという心理が壁です。" }
                        ] 
                    }
                ]
            },
            {
                category: "カテゴリーC：【見た目と中身】変化の正体を探る",
                icon: "eye", color: "text-amber-600",
                items: [
                    { 
                        id: 5, 
                        q: "もし閏土が、昔と同じツヤツヤした健康的な顔のままだったら、「私」は言葉を失ったかな？", 
                        options: [
                            { type: 'money', label: "失わない", sub: "「変わらないね！」と抱きつく", reason: "「私」がショックを受けた最大の原因は「見た目の老化」だと捉えています。その老化の原因は、過酷な労働（カネの問題）にあります。" }, 
                            { type: 'heart', label: "失う", sub: "やっぱり話が続かない", reason: "見た目が若くても、信じているもの（科学vs迷信）が違えば、やっぱり話は噛み合わないと考えているからです。" }
                        ] 
                    },
                    { 
                        id: 6, 
                        q: "閏土が去り際に「香炉（神様グッズ）」じゃなくて、「現金」を欲しがったら、「私」はどう思った？", 
                        options: [
                            { type: 'money', label: "納得する", sub: "まあ、生活苦しいもんね", reason: "香炉だろうが現金だろうが、結局は「生きるために必要なもの」だと捉えています。形が違うだけで、根本原因は貧困です。" }, 
                            { type: 'heart', label: "軽蔑する", sub: "えっ、がめついな", reason: "「私」は美しい思い出や「品格」を求めているから、生々しい現実を突きつけられると引いてしまう（心を閉ざす）と考えているからです。" }
                        ] 
                    }
                ]
            },
            {
                category: "カテゴリーD：【未来】次世代の関係を予想する",
                icon: "users", color: "text-indigo-600",
                items: [
                    { 
                        id: 7, 
                        q: "10年後、水生（閏土の子）と宏児（私の子）が再会したら、二人は仲良くなれる？", 
                        options: [
                            { type: 'money', label: "なれない", sub: "水生が「旦那様」と呼ぶ", reason: "結局、水生は学校に行けず、宏児はエリートになるからです。親と同じ「経済格差」の道を辿る以上、同じ壁ができると考えます。" }, 
                            { type: 'heart', label: "なれる", sub: "対等に話す", reason: "もし仲良くなれるなら、今の二人に壁があるのは「古い時代の教育（身分意識）」のせいだからです。新しい心を持った世代なら、壁は越えられます。" }
                            ] 
                    }
                ]
            },
            {
                category: "カテゴリーE：【罪と罰】「灰の中の食器」事件をどう見る？",
                icon: "gavel", color: "text-slate-600",
                items: [
                    { 
                        id: 8, 
                        q: "閏土が「灰の中に食器を隠した」と聞いた時、君はどう感じた？", 
                        options: [
                            { type: 'money', label: "同情する", sub: "なりふり構わないほど苦しかった", reason: "あの行為を「盗み（悪）」ではなく「生存戦略」と捉えているからです。プライドを捨てさせるほどの貧困が原因だと考えています。" }, 
                            { type: 'heart', label: "ショック", sub: "純朴な閏土は死んでしまった", reason: "貧しさそのものより、心が卑しく変わってしまったこと（道徳心の低下）に絶望を感じているからです。これは心の問題です。" }
                        ] 
                    },
                    { 
                        id: 9, 
                        q: "もし楊おばさんがいなくて、村がもっと平和だったら、閏土は食器を盗んだかな？", 
                        options: [
                            { type: 'money', label: "盗まない", sub: "平和に暮らす", reason: "閏土個人が悪いのではなく、村全体を覆う「奪い合いの空気（貧困の連鎖）」が彼を追い詰めたと考えているからです。" }, 
                            { type: 'heart', label: "盗む", sub: "やっぱりチャンスがあればやる", reason: "周囲の環境に関係なく、今の閏土の心はすでに麻痺し、倫理観が壊れていると捉えているからです。" }
                        ] 
                    }
                ]
            },
            {
                category: "カテゴリーF：【責任の所在】悪いのは「誰」だ？",
                icon: "brain", color: "text-purple-600",
                items: [
                    { 
                        id: 10, 
                        q: "閏土が「石像（木偶の坊）」みたいになった一番の犯人は何だと思う？", 
                        options: [
                            { type: 'money', label: "社会システム", sub: "軍閥・重税・地主", reason: "個人の努力ではどうにもならない「社会システム（カネの搾取構造）」が人間を壊したと考えているからです。" }, 
                            { type: 'heart', label: "古い慣習", sub: "伝統・迷信・教育不足", reason: "彼を縛っているのは税金だけでなく、「こう生きるしかない」という思い込みや、古い慣習（心の中の鎖）だと考えているからです。" }
                        ] 
                    },
                    { 
                        id: 11, 
                        q: "もし閏土が、現代の日本に生まれていたら、「私」と親友になれたかな？", 
                        options: [
                            { type: 'money', label: "なれた", sub: "普通の友達になる", reason: "現代日本のように極端な貧困や飢餓がなければ、性格自体は合うはずだと考えているからです。邪魔をしていたのは環境（カネ）だけです。" }, 
                            { type: 'heart', label: "なれない", sub: "やっぱり話が合わない", reason: "結局、進学するコースや興味関心が違えば、話は合わなくなると考えているからです。人間としての「住む世界（価値観）」の違いは埋まりません。" }
                        ] 
                    }
                ]
            },
            {
                category: "カテゴリーG：【希望の行方】ラストシーンをどう読む？",
                icon: "arrow-right", color: "text-cyan-600",
                items: [
                    { 
                        id: 12, 
                        q: "最後の「歩く人が多くなれば道になる」という希望。これを実現するために、一番必要なのはどっち？", 
                        options: [
                            { type: 'money', label: "豊かさ", sub: "政治が変わって、みんなが豊かになること", reason: "貧困が解決しない限り、誰もが自分の生活で手一杯で、道を作る（新しい関係を築く）余裕なんて生まれないと捉えているからです。" }, 
                            { type: 'heart', label: "意識改革", sub: "みんなが意識を変えて、偶像（迷信）を捨てること", reason: "いくら豊かになっても、差別意識や依存心がある限り、本当の「新しい生活」は来ないと捉えているからです。革命は心の中で起きるべきものです。" }
                        ] 
                    },
                    { 
                        id: 13, 
                        q: "宏児（私の子）と水生（閏土の子）が、将来「厚い壁」を感じないために必要なアイテムは？", 
                        options: [
                            { type: 'money', label: "ツール", sub: "スマホやチケット（カネ）", reason: "連絡を取り合ったり会いに行ったりする「経済的な余裕」さえあれば、関係は維持できると考えているからです。" }, 
                            { type: 'heart', label: "精神力", sub: "勇気や偏見のない心", reason: "親が決めた身分や格差を飛び越えるには、強い意志（心）が必要だと考えているからです。" }
                        ] 
                    }
                ]
            },
            {
                category: "カテゴリーH：【私への疑惑】語り手を疑ってみる",
                icon: "help-circle", color: "text-rose-400",
                items: [
                    { 
                        id: 14, 
                        q: "「私」は楊おばさんを「コンパス」、閏土を「石像」と呼んだ。このあだ名についてどう思う？", 
                        options: [
                            { type: 'money', label: "うまい例え", sub: "特徴を捉えてるな", reason: "「私」の視点を客観的で正しいものとして受け入れています。つまり、「私」のせいではなく、客観的な事実（貧困による変化）が原因だと考えがちです。" }, 
                            { type: 'heart', label: "ひどいな", sub: "見下してるな", reason: "「私」の中に、無自覚な差別意識や冷たさを感じ取っているからです。その「上から目線」こそが壁を作った犯人です。" }
                        ] 
                    },
                    { 
                        id: 15, 
                        q: "「私」が故郷を離れる時、「名残惜しい気はしない」と言った。これは本心？", 
                        options: [
                            { type: 'money', label: "本心", sub: "もう未練はない", reason: "故郷はもう「生きられない場所（貧困の地）」になってしまった。現実的に生活を立て直すには、捨てるしかないという判断です。" }, 
                            { type: 'heart', label: "強がり", sub: "本当は悲しい", reason: "期待していた「美しい故郷」が壊れてしまったことへの、精神的なショックを隠そうとしているからです。" }
                        ] 
                    }
                ]
            }
        ];

        // --- 1. Diagnosis Component (診断ツール) ---
        const Diagnosis = ({ answers, onAnswer }) => {
            const [expandedCards, setExpandedCards] = useState({});

            const toggleExpand = (id) => setExpandedCards(prev => ({ ...prev, [id]: !prev[id] }));

            const handleLocalAnswer = (qId, type) => {
                onAnswer(qId, type);
                // 自動で解説を開く
                if (!expandedCards[qId]) setExpandedCards(prev => ({ ...prev, [qId]: true }));
            };

            return (
                // slide-in はここ（ルート）には付けない！ fixed要素に悪影響があるため。
                <div className="pb-40">
                    
                    {/* 質問カードのリスト */}
                    <div className="space-y-8 slide-in">
                        {questions.map((category, idx) => (
                            <section key={idx} className="space-y-4">
                                <div className="flex items-center gap-2 border-b-2 border-slate-200 pb-2">
                                    <Icon name={category.icon} className={category.color} />
                                    <h3 className="font-bold text-slate-700">{category.category}</h3>
                                </div>
                                <div className="grid gap-4">
                                    {category.items.map((item) => {
                                        const isAnswered = answers[item.id];
                                        const isExpanded = expandedCards[item.id];
                                        return (
                                            <div key={item.id} className={`bg-white rounded-xl shadow-sm border-2 transition-all ${isAnswered ? 'border-slate-300' : 'border-slate-100'}`}>
                                                <div className="p-4">
                                                    <p className="font-bold text-slate-800 mb-4"><span className="bg-slate-100 text-xs px-2 py-1 rounded mr-2">Q{item.id}</span>{item.q}</p>
                                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                                                        {item.options.map((opt) => (
                                                            <button key={opt.type} onClick={() => handleLocalAnswer(item.id, opt.type)}
                                                                className={`p-4 rounded-lg text-left border flex flex-col justify-center transition-all min-h-[100px] ${answers[item.id] === opt.type 
                                                                    ? (opt.type === 'money' ? 'bg-emerald-50 border-emerald-500 ring-1 ring-emerald-500' : 'bg-rose-50 border-rose-500 ring-1 ring-rose-500')
                                                                    : 'bg-white border-slate-200 hover:bg-slate-50'}`}>
                                                                <div className="flex justify-between items-start w-full mb-1">
                                                                    <div className={`font-bold text-lg ${opt.type === 'money' ? 'text-emerald-700' : 'text-rose-700'}`}>{opt.label}</div>
                                                                    {answers[item.id] === opt.type && <span className="text-xs bg-slate-800 text-white px-2 py-1 rounded-full whitespace-nowrap ml-2">選択中</span>}
                                                                </div>
                                                                <div className="text-sm text-slate-600">{opt.sub}</div>
                                                            </button>
                                                        ))}
                                                    </div>
                                                </div>
                                                {isAnswered && (
                                                    <div className={`bg-slate-50 border-t border-slate-100 overflow-hidden transition-all ${isExpanded ? 'max-h-96 p-5' : 'max-h-0'}`}>
                                                        <div className="flex gap-3 text-sm">
                                                            <div className={`w-1 flex-shrink-0 rounded ${answers[item.id] === 'money' ? 'bg-emerald-500' : 'bg-rose-500'}`}></div>
                                                            <div>
                                                                <p className="font-bold text-slate-500 text-xs mb-1 uppercase tracking-wider">
                                                                    👉 あなたは 【 {answers[item.id] === 'money' ? 'カネ（経済格差）派' : '心（精神格差）派'} 】
                                                                </p>
                                                                <p className="text-slate-800 leading-relaxed"><span className="font-bold">なぜなら：</span>{item.options.find(o => o.type === answers[item.id]).reason}</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                )}
                                                {isAnswered && (
                                                    <button onClick={() => toggleExpand(item.id)} className="w-full text-center py-2 text-xs text-slate-400 hover:bg-slate-50 border-t border-slate-100 flex items-center justify-center gap-1">
                                                        {isExpanded ? <>解説を閉じる <Icon name="chevron-up" size={12}/></> : <>解説を見る <Icon name="chevron-down" size={12}/></>}
                                                    </button>
                                                )}
                                            </div>
                                        );
                                    })}
                                </div>
                            </section>
                        ))}
                    </div>
                </div>
            );
        };

        // --- 2. Reference Component (探究資料) ---
        const Reference = () => {
            return (
                <div className="space-y-16 pb-32 slide-in">
                    
                    {/* Method Section */}
                    <section id="method" className="bg-white border-4 border-amber-500 rounded-2xl p-6 md:p-10 relative mt-8 shadow-sm">
                        <div className="absolute -top-4 left-1/2 transform -translate-x-1/2 bg-amber-500 text-white font-bold px-6 py-1 rounded-full shadow">必勝メソッド</div>
                        <h2 className="text-2xl font-bold text-center mb-6 serif">最強の「論拠」の方程式</h2>
                        <div className="flex flex-col md:flex-row items-center justify-center gap-4 text-center mb-8">
                            <div className="bg-indigo-50 border-t-4 border-indigo-600 p-4 rounded-xl flex-1 w-full">
                                <h3 className="font-bold text-indigo-900 mb-1">教科書本文</h3>
                                <p className="text-xs text-slate-500">記述・セリフ</p>
                                <p className="text-indigo-600 font-bold text-sm mt-2">事実 (Fact)</p>
                            </div>
                            <div className="text-2xl text-slate-300 font-bold">×</div>
                            <div className="bg-emerald-50 border-t-4 border-emerald-500 p-4 rounded-xl flex-1 w-full">
                                <h3 className="font-bold text-emerald-900 mb-1">探究資料 A~H</h3>
                                <p className="text-xs text-slate-500">歴史・数字・背景</p>
                                <p className="text-emerald-600 font-bold text-sm mt-2">根拠 (Evidence)</p>
                            </div>
                            <div className="text-2xl text-slate-300 font-bold">=</div>
                            <div className="bg-slate-800 text-white border-t-4 border-amber-500 p-4 rounded-xl flex-1 w-full shadow-lg">
                                <h3 className="font-bold text-amber-400 mb-1">最強の論拠</h3>
                                <p className="text-xs text-slate-400">反論できない意見</p>
                                <p className="text-amber-500 font-bold text-sm mt-2">説得力 ∞</p>
                            </div>
                        </div>
                        <div className="bg-slate-50 rounded-lg p-4 border border-slate-200">
                            <h4 className="font-bold text-sm text-slate-600 mb-3 text-center">組み合わせ例</h4>
                            <div className="grid md:grid-cols-2 gap-4 text-sm">
                                <div className="bg-white p-3 rounded border border-emerald-200">
                                    <span className="bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded text-xs font-bold mb-2 inline-block">カネ派の作戦</span>
                                    <p>教科書「売りに行けば税金を取られる」<br/>＋ 資料B「通行税・30年分の前借り」<br/><strong className="text-emerald-600">＝ 努力不足ではない。システムによる搾取だ。</strong></p>
                                </div>
                                <div className="bg-white p-3 rounded border border-rose-200">
                                    <span className="bg-rose-100 text-rose-700 px-2 py-0.5 rounded text-xs font-bold mb-2 inline-block">心派の作戦</span>
                                    <p>教科書「旦那様！」<br/>＋ 資料F「権威への依存・身分制度による安心」<br/><strong className="text-rose-600">＝ カネではない。自ら身分制度にすがった心の壁だ。</strong></p>
                                </div>
                            </div>
                        </div>
                    </section>

                    {/* A: History */}
                    <section id="history" className="bg-white rounded-2xl p-6 md:p-8 shadow-sm border border-slate-200">
                        <div className="flex items-center gap-4 mb-6 border-b pb-4">
                            <div className="w-12 h-12 bg-indigo-100 text-indigo-600 rounded-lg flex items-center justify-center"><Icon name="clock" /></div>
                            <div>
                                <h2 className="text-2xl font-bold serif text-slate-800">資料A：激動の30年史</h2>
                                <p className="text-sm text-slate-500 font-bold">「革命」はなぜ民衆を救えなかったのか？</p>
                            </div>
                        </div>
                        <div className="relative border-l-4 border-slate-200 ml-4 pl-6 space-y-8">
                            <div className="relative">
                                <div className="absolute -left-[34px] top-1 w-4 h-4 rounded-full bg-slate-400 border-4 border-white shadow-sm"></div>
                                <div className="mb-2"><span className="font-bold text-slate-400 text-sm">1900年頃（少年時代）</span></div>
                                <h3 className="font-bold text-lg mb-1">清王朝 末期</h3>
                                <p className="text-sm text-slate-600">政治は腐敗していたが、伝統的な秩序は機能。「私」の家は裕福で、身分を超えた交流が可能だった。</p>
                            </div>
                            <div className="relative">
                                <div className="absolute -left-[34px] top-1 w-4 h-4 rounded-full bg-rose-500 border-4 border-white shadow-sm"></div>
                                <div className="mb-2"><span className="font-bold text-rose-500 text-sm">1911年（転換点）</span></div>
                                <h3 className="font-bold text-lg mb-1 text-rose-600">辛亥（しんがい）革命</h3>
                                <p className="text-sm text-slate-600">清が滅び、アジア初の共和国「中華民国」誕生。知識人は「これで自由な国になる」と熱狂した。</p>
                            </div>
                            <div className="relative">
                                <div className="absolute -left-[34px] top-1 w-4 h-4 rounded-full bg-slate-400 border-4 border-white shadow-sm"></div>
                                <div className="mb-2"><span className="font-bold text-slate-400 text-sm">1912年</span></div>
                                <h3 className="font-bold text-lg mb-1">「私」の変化</h3>
                                <p className="text-sm text-slate-600">「私」が希望を持って、強制された髪型（辮髪）をやめたのはこの頃。</p>
                            </div>
                            <div className="relative">
                                <div className="absolute -left-[34px] top-1 w-4 h-4 rounded-full bg-slate-600 border-4 border-white shadow-sm"></div>
                                <div className="mb-2"><span className="font-bold text-slate-600 text-sm">1916年〜</span></div>
                                <h3 className="font-bold text-lg mb-1">軍閥割拠（ぐんばつかっきょ）</h3>
                                <p className="text-sm text-slate-600">強力なリーダーがいなくなり、地方のボス（軍閥）が勝手に軍隊を作って仲間割れを開始。治安は革命前より悪化。</p>
                            </div>
                             <div className="relative">
                                <div className="absolute -left-[34px] top-1 w-4 h-4 rounded-full bg-slate-800 border-4 border-white shadow-sm"></div>
                                <div className="mb-2"><span className="font-bold text-slate-800 text-sm">1921年（現在）</span></div>
                                <h3 className="font-bold text-lg mb-1">物語の舞台</h3>
                                <p className="text-sm text-slate-600">「革命で良くなるはずだったのに、なぜこんなに酷いことになったのか？」という絶望の中で、「私」は故郷を去る。</p>
                            </div>
                        </div>
                    </section>

                    {/* B: Tax */}
                    <section id="taxes" className="bg-white rounded-2xl p-6 md:p-8 shadow-sm border border-slate-200">
                        <div className="flex items-center gap-4 mb-6 border-b pb-4">
                            <div className="w-12 h-12 bg-emerald-100 text-emerald-600 rounded-lg flex items-center justify-center"><Icon name="file-text" /></div>
                            <div>
                                <h2 className="text-2xl font-bold serif text-slate-800">資料B：軍閥からの過酷な税金の徴収</h2>
                                <p className="text-sm text-slate-500 font-bold">30年先の未来まで奪うシステム</p>
                            </div>
                        </div>
                        <div className="space-y-6">
                            <div className="bg-slate-50 p-4 rounded-xl">
                                <h3 className="font-bold text-lg mb-2">① 税金の「前借り」徴収</h3>
                                <p className="text-sm text-slate-600 mb-3">軍閥は戦費のため、未来の税金まで無理やり徴収した。四川省などでは<strong className="text-rose-600">「21世紀半ば（2050年頃）」</strong>分まで徴収済みだった。</p>
                                <div className="w-full h-8 bg-slate-200 rounded-full flex overflow-hidden">
                                    <div className="w-[10%] bg-emerald-500 flex items-center justify-center text-[10px] text-white font-bold">1921</div>
                                    <div className="w-[90%] bg-[repeating-linear-gradient(45deg,#ef4444,#ef4444_10px,#dc2626_10px,#dc2626_20px)] flex items-center justify-center text-[10px] text-white font-bold tracking-widest">
                                        孫の代まで没収済み
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h3 className="font-bold text-lg mb-2">② 逃げ場のない雑税</h3>
                                <p className="text-sm text-slate-600 mb-2">閏土の言う「売りに行けば税金を取られる」とは通行税（釐金）のこと。それ以外にも…</p>
                                <div className="flex flex-wrap gap-2">
                                    {['土地税', '家畜税', 'アヘン税', '塩税', 'タバコ税', '帽子税', '門税'].map(t => (
                                        <span key={t} className="bg-slate-100 text-slate-600 px-3 py-1 rounded text-xs font-bold">{t}</span>
                                    ))}
                                    <span className="bg-rose-100 text-rose-700 px-3 py-1 rounded text-xs font-bold">+軍隊の略奪</span>
                                </div>
                            </div>
                        </div>
                    </section>

                    {/* C: Currency */}
                    <section id="currency" className="bg-white rounded-2xl p-6 md:p-8 shadow-sm border border-slate-200">
                        <div className="flex items-center gap-4 mb-6 border-b pb-4">
                            <div className="w-12 h-12 bg-amber-100 text-amber-600 rounded-lg flex items-center justify-center"><Icon name="coins" /></div>
                            <div>
                                <h2 className="text-2xl font-bold serif text-slate-800">資料C：貨幣経済の罠</h2>
                                <p className="text-sm text-slate-500 font-bold">働けば働くほど貧しくなる「交換レート」</p>
                            </div>
                        </div>
                        <div className="grid md:grid-cols-2 gap-8">
                            <div>
                                <h3 className="font-bold mb-3">農民を殺す二重通貨構造</h3>
                                <div className="space-y-3">
                                    <div className="bg-amber-50 p-3 rounded-lg border border-amber-100">
                                        <div className="flex justify-between items-center mb-1">
                                            <span className="font-bold text-amber-800">農民の収入：銅貨</span>
                                            <Icon name="trending-down" className="text-rose-500"/>
                                        </div>
                                        <p className="text-xs text-slate-600">日常の小銭。軍閥が乱発し価値が大暴落。</p>
                                    </div>
                                    <div className="bg-indigo-50 p-3 rounded-lg border border-indigo-100">
                                        <div className="flex justify-between items-center mb-1">
                                            <span className="font-bold text-indigo-800">税金の支払：銀貨</span>
                                            <Icon name="trending-up" className="text-blue-500"/>
                                        </div>
                                        <p className="text-xs text-slate-600">納税に必要。「私」が持つ強いお金。</p>
                                    </div>
                                </div>
                            </div>
                            <div className="bg-slate-50 rounded-xl p-4 text-center">
                                <h3 className="font-bold text-sm text-slate-500 mb-4">銀貨1枚を買うのに必要な銅貨</h3>
                                <div className="flex items-end justify-center gap-6 h-32 mb-2">
                                    <div className="w-16 bg-slate-300 rounded-t h-[60%] flex items-center justify-center text-white font-bold shadow">100</div>
                                    <Icon name="arrow-right" className="mb-8 text-slate-300"/>
                                    <div className="w-16 bg-rose-500 rounded-t h-[90%] flex items-center justify-center text-white font-bold shadow animate-pulse">140</div>
                                </div>
                                <p className="text-xs font-bold text-rose-600">何もしなくても借金が1.4倍に増える</p>
                            </div>
                        </div>
                    </section>

                    {/* D: Education */}
                    <section id="education" className="bg-white rounded-2xl p-6 md:p-8 shadow-sm border border-slate-200">
                         <div className="flex items-center gap-4 mb-6 border-b pb-4">
                            <div className="w-12 h-12 bg-blue-100 text-blue-600 rounded-lg flex items-center justify-center"><Icon name="book-open" /></div>
                            <div>
                                <h2 className="text-2xl font-bold serif text-slate-800">資料D：「私」と「閏土」の時代・立場による常識の変化</h2>
                                <p className="text-sm text-slate-500 font-bold">1%のエリート vs 99%の農民</p>
                            </div>
                        </div>
                        <div className="overflow-x-auto">
                            <table className="w-full text-sm text-left">
                                <thead className="bg-slate-50 text-slate-500">
                                    <tr>
                                        <th className="p-3 rounded-tl-lg">比較項目</th>
                                        <th className="p-3 text-indigo-700 bg-indigo-50">「私」の世界</th>
                                        <th className="p-3 text-amber-800 bg-amber-50 rounded-tr-lg">閏土の世界</th>
                                    </tr>
                                </thead>
                                <tbody className="divide-y divide-slate-100">
                                    <tr>
                                        <th className="p-3 font-bold text-slate-600">属性</th>
                                        <td className="p-3 bg-indigo-50/30"><strong>識字率1%未満の超エリート</strong><br/>科挙廃止後の新教育、留学経験</td>
                                        <td className="p-3 bg-amber-50/30"><strong>非識字（文字が読めない）</strong><br/>情報は村の噂や言い伝えのみ</td>
                                    </tr>
                                    <tr>
                                        <th className="p-3 font-bold text-slate-600">思想</th>
                                        <td className="p-3 bg-indigo-50/30"><strong>科学・進化論・民主主義</strong><br/>「神はいない」合理的思考</td>
                                        <td className="p-3 bg-amber-50/30"><strong>伝統・運命論・多神教</strong><br/>苦難は運命であり耐えるしかない</td>
                                    </tr>
                                    <tr>
                                        <th className="p-3 font-bold text-slate-600">信仰</th>
                                        <td className="p-3 bg-indigo-50/30"><strong>無神論</strong><br/>「偶像」を迷信と笑う</td>
                                        <td className="p-3 bg-amber-50/30"><strong>神頼み</strong><br/>救いは「香炉」のみと信じる</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </section>

                    {/* E: Survival */}
                    <section id="survival" className="bg-white rounded-2xl p-6 md:p-8 shadow-sm border border-slate-200">
                        <div className="flex items-center gap-4 mb-6 border-b pb-4">
                            <div className="w-12 h-12 bg-rose-100 text-rose-600 rounded-lg flex items-center justify-center"><Icon name="skull" /></div>
                            <div>
                                <h2 className="text-2xl font-bold serif text-slate-800">資料E：極限の生存環境</h2>
                                <p className="text-sm text-slate-500 font-bold">1920年 華北大飢饉</p>
                            </div>
                        </div>
                        <div className="space-y-6">
                            <p className="text-sm text-slate-600">物語執筆の前年、未曾有の大干ばつが発生。「子供を売る」「木の皮を食べる」は日常茶飯事。閏土の「松の幹のような手」はこれを生き延びた証。</p>
                            <div className="grid grid-cols-3 gap-4 text-center">
                                <div className="bg-slate-50 p-4 rounded-xl">
                                    <div className="text-2xl font-black text-rose-600">2000万</div>
                                    <div className="text-xs font-bold text-slate-500">被災者数</div>
                                </div>
                                <div className="bg-slate-50 p-4 rounded-xl">
                                    <div className="text-2xl font-black text-slate-700">50万</div>
                                    <div className="text-xs font-bold text-slate-500">死者数</div>
                                </div>
                                <div className="bg-slate-50 p-4 rounded-xl">
                                    <div className="text-2xl font-black text-slate-700">30代</div>
                                    <div className="text-xs font-bold text-slate-500">平均寿命</div>
                                </div>
                            </div>
                            <div className="bg-rose-50 text-rose-900 p-4 rounded-xl text-center border border-rose-100">
                                <h3 className="font-bold mb-2 flex items-center justify-center gap-2"><Icon name="users" size={16}/> なぜ「多産」なのか？</h3>
                                <p className="text-sm">「貧乏人の子だくさん」ではない。乳幼児死亡率が極めて高いため、多く産まなければ全滅して家が絶えてしまう。「多産」は生存のための悲しい戦略。</p>
                            </div>
                        </div>
                    </section>

                    {/* F: Psychology */}
                    <section id="psychology" className="bg-white rounded-2xl p-6 md:p-8 shadow-sm border border-slate-200">
                         <div className="flex items-center gap-4 mb-6 border-b pb-4">
                            <div className="w-12 h-12 bg-purple-100 text-purple-600 rounded-lg flex items-center justify-center"><Icon name="brain" /></div>
                            <div>
                                <h2 className="text-2xl font-bold serif text-slate-800">資料F：心理学的分析</h2>
                                <p className="text-sm text-slate-500 font-bold">なぜ「木偶の坊」になったのか？</p>
                            </div>
                        </div>
                        <div className="grid md:grid-cols-2 gap-6">
                            <div className="bg-purple-50 p-4 rounded-xl border border-purple-100">
                                <h3 className="font-bold text-purple-800 mb-2 flex items-center gap-2"><Icon name="zap-off" size={18}/> 学習性無力感</h3>
                                <p className="text-sm text-slate-700">長期間、回避不能なストレス（重税・飢餓）にさらされると、人は「何をしても無駄だ」と学習し、抵抗する気力を失う。沈黙は愚かさではなく<strong>「心の麻痺（防衛反応）」</strong>。</p>
                            </div>
                            <div className="bg-slate-50 p-4 rounded-xl border border-slate-200">
                                <h3 className="font-bold text-slate-700 mb-2 flex items-center gap-2"><Icon name="shield" size={18}/> 伝統的権威への依存</h3>
                                <p className="text-sm text-slate-700">社会が混乱した時、人は「昔ながらのルール」にすがる。「旦那様と使用人」という関係は、閏土にとって唯一安心できる<strong>「自分の居場所」</strong>だった。</p>
                            </div>
                        </div>
                    </section>

                    {/* G: Appearance */}
                    <section id="appearance" className="bg-white rounded-2xl p-6 md:p-8 shadow-sm border border-slate-200">
                        <div className="flex items-center gap-4 mb-6 border-b pb-4">
                            <div className="w-12 h-12 bg-slate-100 text-slate-600 rounded-lg flex items-center justify-center"><Icon name="scissors" /></div>
                            <div>
                                <h2 className="text-2xl font-bold serif text-slate-800">資料G：外見（辮髪）の違い</h2>
                                <p className="text-sm text-slate-500 font-bold">一目でわかる「住む世界の違い」</p>
                            </div>
                        </div>
                        <div className="flex items-center justify-around bg-slate-50 rounded-xl p-6">
                            <div className="text-center">
                                <Icon name="scissors" className="mx-auto mb-2 text-indigo-600" size={32}/>
                                <h3 className="font-bold text-indigo-800 mb-1">「私」</h3>
                                <p className="text-xs text-slate-600 font-bold">髪を切っている</p>
                                <p className="text-xs text-slate-500 mt-1">革命支持・モダンの証<br/>新しい時代</p>
                            </div>
                            <div className="font-black text-slate-300 text-xl">VS</div>
                            <div className="text-center">
                                <Icon name="lock" className="mx-auto mb-2 text-amber-700" size={32}/>
                                <h3 className="font-bold text-amber-800 mb-1">閏土</h3>
                                <p className="text-xs text-slate-600 font-bold">髪を残している</p>
                                <p className="text-xs text-slate-500 mt-1">迷信・恐怖・伝統<br/>古い時代</p>
                            </div>
                        </div>
                        <p className="text-center text-sm text-slate-500 mt-4">再会した瞬間、言葉を交わす前に「違う世界の人間だ」と直感する。</p>
                    </section>

                    {/* H: Philosophy */}
                    <section id="philosophy" className="bg-white rounded-2xl p-6 md:p-8 shadow-sm border border-slate-200">
                        <div className="flex items-center gap-4 mb-6 border-b pb-4">
                            <div className="w-12 h-12 bg-slate-800 text-white rounded-lg flex items-center justify-center"><Icon name="lightbulb" /></div>
                            <div>
                                <h2 className="text-2xl font-bold serif text-slate-800">資料H：希望と偶像</h2>
                                <p className="text-sm text-slate-500 font-bold">ラストシーンの解釈に向けて</p>
                            </div>
                        </div>
                        <div className="grid md:grid-cols-2 gap-6">
                            <div className="bg-amber-50 p-5 rounded-xl border border-amber-100">
                                <h3 className="font-bold text-amber-800 mb-2 flex items-center gap-2"><Icon name="flame" size={18}/> 偶像（アイドル）</h3>
                                <p className="text-sm text-slate-700">対象：閏土にとっての「香炉・燭台」。<br/>「私」はこれを迷信だと笑ったが、直後に「私の希望も手製の偶像ではないか」と自問する。形は違っても、二人とも「すがるもの」を求めている。</p>
                            </div>
                            <div className="bg-indigo-50 p-5 rounded-xl border border-indigo-100">
                                <h3 className="font-bold text-indigo-800 mb-2 flex items-center gap-2"><Icon name="footprints" size={18}/> 地上の道</h3>
                                <p className="text-sm text-slate-700">対象：「私」にとっての「希望」。<br/>「もともと地上には道はない。歩く人が多くなれば、それが道になるのだ」。これは「待てば来る」という予言ではない。「今は道がない」という絶望を出発点にした、<strong>行動への意志</strong>である。</p>
                            </div>
                        </div>
                    </section>

                    <div className="text-center py-10">
                        <p className="font-serif font-bold text-2xl text-slate-400">Facts are here. The logic is yours.</p>
                        <p className="text-slate-400 mt-2 text-sm">2025 中学校国語『故郷』ディベート探究資料</p>
                    </div>
                </div>
            );
        };

        // --- 3. Main App Component (統合管理) ---
        const App = () => {
            const [mode, setMode] = useState('diagnosis'); // 'diagnosis' or 'reference'
            const [answers, setAnswers] = useState({}); // Lifted state for answers

            const handleAnswer = (qId, type) => {
                setAnswers(prev => ({ ...prev, [qId]: type }));
            };

            const calculateScore = () => {
                let money = 0;
                let heart = 0;
                Object.values(answers).forEach(type => {
                    if (type === 'money') money++;
                    if (type === 'heart') heart++;
                });
                return { money, heart, total: money + heart };
            };

            const scores = calculateScore();

            return (
                <div className="min-h-screen bg-slate-50 text-slate-800 font-sans">
                    {/* Header */}
                    <header className="bg-slate-900 text-white pt-8 pb-12 shadow-lg relative overflow-hidden">
                        <div className="max-w-4xl mx-auto px-4 relative z-10">
                            <div className="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6">
                                <div>
                                    <span className="bg-amber-500 text-slate-900 text-xs font-bold px-3 py-1 rounded-full inline-block mb-2 shadow">中3国語『故郷』</span>
                                    <h1 className="text-2xl md:text-3xl font-black tracking-wider serif mb-2 leading-tight">
                                        論題：「私」と「閏土」の心を隔てた『厚い壁』の正体は、「経済格差（カネ）」か、「精神的格差（心）」か。
                                    </h1>
                                    <p className="text-slate-400 text-sm">直感的な「診断」と、客観的な「資料」。二つのアプローチで真実に迫る。</p>
                                </div>
                            </div>
                            
                            {/* Navigation Tabs */}
                            <div className="flex p-1 bg-slate-800/50 rounded-xl backdrop-blur-sm border border-slate-700/50">
                                <button 
                                    onClick={() => { window.scrollTo(0,0); setMode('diagnosis'); }}
                                    className={`flex-1 flex items-center justify-center gap-2 py-3 rounded-lg font-bold transition-all ${mode === 'diagnosis' ? 'bg-amber-500 text-slate-900 shadow-md' : 'text-slate-400 hover:text-white hover:bg-slate-700'}`}
                                >
                                    <Icon name="check-circle" size={20}/>
                                    <span className="hidden md:inline">STEP 1:</span> 思考タイプ診断
                                </button>
                                <button 
                                    onClick={() => { window.scrollTo(0,0); setMode('reference'); }}
                                    className={`flex-1 flex items-center justify-center gap-2 py-3 rounded-lg font-bold transition-all ${mode === 'reference' ? 'bg-amber-500 text-slate-900 shadow-md' : 'text-slate-400 hover:text-white hover:bg-slate-700'}`}
                                >
                                    <Icon name="book-open" size={20}/>
                                    <span className="hidden md:inline">STEP 2:</span> 徹底解剖データ
                                </button>
                            </div>
                        </div>
                        {/* Background Decoration */}
                        <div className="absolute top-0 right-0 w-64 h-64 bg-amber-500/10 rounded-full blur-3xl transform translate-x-1/2 -translate-y-1/2"></div>
                        <div className="absolute bottom-0 left-0 w-48 h-48 bg-indigo-500/10 rounded-full blur-3xl transform -translate-x-1/2 translate-y-1/2"></div>
                    </header>

                    {/* Main Content Area */}
                    <main className="max-w-4xl mx-auto px-4 py-8 relative z-20">
                        {mode === 'diagnosis' ? (
                            <Diagnosis answers={answers} onAnswer={handleAnswer} />
                        ) : (
                            <Reference />
                        )}
                    </main>

                    {/* 下部固定の追尾型メーター＆ボタン (Always Visible) */}
                    {scores.total > 0 && (
                        <div className="fixed bottom-0 left-0 right-0 bg-white border-t-2 border-slate-200 shadow-[0_-4px_15px_-3px_rgba(0,0,0,0.1)] z-[9999]">
                            {/* メーター部分 */}
                            <div className="px-4 pt-3 pb-2 max-w-4xl mx-auto">
                                <div className="flex justify-between text-xs font-bold mb-1">
                                    <span className="flex items-center gap-1 text-emerald-700">
                                        <Icon name="banknote" size={14}/> カネ派: {scores.money}
                                    </span>
                                    <span className="text-slate-400 font-normal">回答数: {scores.total} / 15</span>
                                    <span className="flex items-center gap-1 text-rose-700">
                                        心派: {scores.heart} <Icon name="heart" size={14}/>
                                    </span>
                                </div>
                                <div className="h-3 bg-slate-100 rounded-full overflow-hidden flex relative">
                                    {/* 中央線 */}
                                    <div className="absolute left-1/2 top-0 bottom-0 w-0.5 bg-slate-300 z-10 opacity-50"></div>
                                    {/* カネ派バー (右寄せで伸びる) */}
                                    <div className="flex-1 flex justify-end bg-slate-50">
                                        <div 
                                            className="h-full bg-emerald-500 transition-all duration-500" 
                                            style={{ width: scores.total === 0 ? '0%' : `${(scores.money / (scores.money + scores.heart || 1)) * 100}%` }}
                                        ></div>
                                    </div>
                                    {/* 心派バー (左寄せで伸びる) */}
                                    <div className="flex-1 flex justify-start bg-slate-50">
                                        <div 
                                            className="h-full bg-rose-500 transition-all duration-500" 
                                            style={{ width: scores.total === 0 ? '0%' : `${(scores.heart / (scores.money + scores.heart || 1)) * 100}%` }}
                                        ></div>
                                    </div>
                                </div>
                            </div>

                            {/* アクションボタン (Modeによって切り替え) */}
                            <div className="px-4 pb-4 pt-1 max-w-4xl mx-auto">
                                {mode === 'diagnosis' ? (
                                    <button 
                                        onClick={() => { window.scrollTo(0,0); setMode('reference'); }} 
                                        className={`w-full py-3 rounded-lg font-bold shadow-md transition flex items-center justify-center gap-2 ${scores.total === 15 ? 'bg-slate-800 text-white animate-bounce shadow-xl' : 'bg-slate-100 text-slate-500 hover:bg-slate-200'}`}
                                    >
                                        {scores.total === 15 ? (
                                            <><Icon name="check-circle" size={20}/> 診断完了！資料で裏付けをとる</>
                                        ) : (
                                            <><Icon name="arrow-right" size={18}/> 途中ですが資料を見る</>
                                        )}
                                    </button>
                                ) : (
                                    <button 
                                        onClick={() => { window.scrollTo(0,0); setMode('diagnosis'); }} 
                                        className="w-full py-3 rounded-lg font-bold shadow-md transition flex items-center justify-center gap-2 bg-amber-100 text-amber-800 hover:bg-amber-200 border border-amber-200"
                                    >
                                        <Icon name="rotate-ccw" size={18}/> 診断画面に戻って回答を修正する
                                    </button>
                                )}
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
